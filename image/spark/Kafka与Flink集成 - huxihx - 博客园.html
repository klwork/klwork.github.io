<!DOCTYPE HTML>
<html lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
    <!--Setting-->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta http-equiv="Cache-Control" content="no-siteapp">
    <meta http-equiv="Cache-Control" content="no-transform">
    <meta name="renderer" content="webkit|ie-comp|ie-stand">
    <meta name="apple-mobile-web-app-capable" content="Klwork">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="format-detection" content="telephone=no,email=no,adress=no">
    <meta name="browsermode" content="application">
    <meta name="screen-orientation" content="portrait">
    <link rel="dns-prefetch" href="http://yoursite.com">
    <!--SEO-->

<meta name="description" content="klwork">





<meta name="robots" content="all">
<meta name="google" content="all">
<meta name="googlebot" content="all">
<meta name="verify" content="all">
    <!--Title-->


<title>Klwork</title>


    <link rel="alternate" href="/atom.xml" title="Klwork" type="application/atom+xml">


    <link rel="icon" href="/favicon.ico">

    



<link rel="stylesheet" href="/css/bootstrap.min.css?rev=3.3.7">
<link rel="stylesheet" href="/css/font-awesome.min.css?rev=4.5.0">
<link rel="stylesheet" href="/css/style.css?rev=@@hash">




    





    

</head>

</html>
<!--[if lte IE 8]>
<style>
    html{ font-size: 1em }
</style>
<![endif]-->
<!--[if lte IE 9]>
<div style="ie">你使用的浏览器版本过低，为了你更好的阅读体验，请更新浏览器的版本或者使用其他现代浏览器，比如Chrome、Firefox、Safari等。</div>
<![endif]-->

<body>
    <header class="main-header" style="background-image:url(/image/ban.png)">
    <div class="main-header-box">
        <a class="header-avatar" href="/" title="wangwei">
            <!--<img src="/img/avatar.jpg" alt="logo头像" class="img-responsive center-block">-->
        </a>
        <h2 style="color: #FAEBD7">专注于快乐的事情</h2>
    </div>
</header>
    <nav class="main-navigation">
    <div class="container">
        <div class="row">
            <div class="col-sm-12">
                <div class="navbar-header"><span class="nav-toggle-button collapsed pull-right" data-toggle="collapse" data-target="#main-menu" id="mnav">
                    <span class="sr-only"></span>
                        <i class="fa fa-bars"></i>
                    </span>
                    <a class="navbar-brand" href="http://yoursite.com">Klwork</a>
                </div>
                <div class="collapse navbar-collapse" id="main-menu">
                    <ul class="menu">
                        
                            <li role="presentation" class="text-center">
                                <a href="/"><i class="fa "></i>主页</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/tags/常用/"><i class="fa "></i>常用</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/tags/更新/"><i class="fa "></i>近期更新</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/机器学习/"><i class="fa "></i>机器学习</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/FRM学习之路/"><i class="fa "></i>FRM学习之路</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/archives/"><i class="fa "></i>时间轴</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/about"><i class="fa "></i>关于</a>
                            </li>
                        
                    </ul>
                </div>
            </div>
        </div>
    </div>
</nav>
    <section class="content-wrap">
        <div class="container">
            <div class="row">
                <main class="col-md-8 main-content ">
                    <article class="post">
    <h1 class="post-head"></h1>
    <div class="post-body">
        <!DOCTYPE html>
<!-- saved from url=(0045)https://www.cnblogs.com/huxi2b/p/7219792.html -->
<html lang="zh-cn"><head><meta name="generator" content="Hexo 3.8.0"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="referrer" content="origin">
    <title>Kafka与Flink集成 - huxihx - 博客园</title>
<meta property="og:description" content="Apache Flink是新一代的分布式流式数据处理框架，它统一的处理引擎既可以处理批数据(batch data)也可以处理流式数据(streaming data)。在实际场景中，Flink利用Apa">
    <link type="text/css" rel="stylesheet" href="./Kafka与Flink集成 - huxihx - 博客园_files/blog-common.css">
<link id="MainCss" type="text/css" rel="stylesheet" href="./Kafka与Flink集成 - huxihx - 博客园_files/bundle-SimpleBlue.css">
<link id="mobile-style" media="only screen and (max-width: 767px)" type="text/css" rel="stylesheet" href="./Kafka与Flink集成 - huxihx - 博客园_files/bundle-SimpleBlue-mobile.css">
    <link title="RSS" type="application/rss+xml" rel="alternate" href="https://www.cnblogs.com/huxi2b/rss">
    <link title="RSD" type="application/rsd+xml" rel="EditURI" href="https://www.cnblogs.com/huxi2b/rsd.xml">
<link type="application/wlwmanifest+xml" rel="wlwmanifest" href="https://www.cnblogs.com/huxi2b/wlwmanifest.xml">
    <script src="./Kafka与Flink集成 - huxihx - 博客园_files/osd.js"></script><script src="./Kafka与Flink集成 - huxihx - 博客园_files/amp4ads-host-v0.js"></script><script src="./Kafka与Flink集成 - huxihx - 博客园_files/pubads_impl_rendering_319.js"></script><script async src="./Kafka与Flink集成 - huxihx - 博客园_files/analytics.js"></script><script type="text/javascript" src="./Kafka与Flink集成 - huxihx - 博客园_files/encoder.js"></script><script src="./Kafka与Flink集成 - huxihx - 博客园_files/jquery-2.2.0.min.js"></script>
    <script>var currentBlogId=219719;var currentBlogApp='huxi2b',cb_enable_mathjax=false;var isLogined=false;</script>
    <script src="./Kafka与Flink集成 - huxihx - 博客园_files/blog-common.js" type="text/javascript"></script>
<link rel="preload" href="./Kafka与Flink集成 - huxihx - 博客园_files/f.txt" as="script"><script type="text/javascript" src="./Kafka与Flink集成 - huxihx - 博客园_files/f.txt"></script><script src="./Kafka与Flink集成 - huxihx - 博客园_files/pubads_impl_319.js" async></script><link rel="prefetch" href="https://tpc.googlesyndication.com/safeframe/1-0-32/html/container.html"></head>
<body>
<a name="top"></a>


<div id="home">
<div id="header">
	<div id="blogTitle">
		
<!--done-->
<div class="title"><a id="Header1_HeaderTitle" class="headermaintitle" href="https://www.cnblogs.com/huxi2b/" target="_blank" rel="noopener">huxihx</a></div>
<div class="subtitle">头像是Kafka微信公众号，请放心订阅！</div>



		
	</div><!--end: blogTitle 博客的标题和副标题 -->
	<div id="navigator">
		
<ul id="navList">
<li id="nav_sitehome"><a id="blog_nav_sitehome" class="menu" href="https://www.cnblogs.com/" target="_blank" rel="noopener">博客园</a></li>
<li id="nav_myhome"><a id="blog_nav_myhome" class="menu" href="https://www.cnblogs.com/huxi2b/" target="_blank" rel="noopener">首页</a></li>
<li id="nav_newpost"><a id="blog_nav_newpost" class="menu" rel="noopener" href="https://i.cnblogs.com/EditPosts.aspx?opt=1" target="_blank">新随笔</a></li>
<li id="nav_contact"><a id="blog_nav_contact" class="menu" rel="noopener" href="https://msg.cnblogs.com/send/huxihx" target="_blank">联系</a></li>
<li id="nav_rss"><a id="blog_nav_rss" class="menu" href="https://www.cnblogs.com/huxi2b/rss" target="_blank" rel="noopener">订阅</a>
<!--<a id="blog_nav_rss_image" class="aHeaderXML" href="https://www.cnblogs.com/huxi2b/rss"><img src="//www.cnblogs.com/images/xml.gif" alt="订阅" /></a>--></li>
<li id="nav_admin"><a id="blog_nav_admin" class="menu" rel="noopener" href="https://i.cnblogs.com/" target="_blank">管理</a></li>
</ul>

		<div class="blogStats">
			
			<div id="blog_stats">
<!--done-->
随笔-88&nbsp;
文章-0&nbsp;
评论-358&nbsp;
</div>
			
		</div><!--end: blogStats -->
	</div><!--end: navigator 博客导航栏 -->
</div><!--end: header 头部 -->
<div id="main">
	<div id="mainContent">
	<div class="forFlow">
		
        <div id="post_detail">
<!--done-->
<div id="topics">
	<div class="post">
		<h1 class="postTitle">
			<a id="cb_post_title_url" class="postTitle2" href="https://www.cnblogs.com/huxi2b/p/7219792.html" target="_blank" rel="noopener">Kafka与Flink集成</a>
		</h1>
		<div class="clear"></div>
		<div class="postBody">
			<div id="cnblogs_post_body" class="blogpost-body"><p><a href="http://flink.apache.org/" target="_blank">Apache Flink</a>是新一代的分布式流式数据处理框架，它统一的处理引擎既可以处理批数据(batch data)也可以处理流式数据(streaming data)。在实际场景中，Flink利用Apache Kafka作为上下游的输入输出十分常见，本文将给出一个可运行的实际例子来集成两者。</p>
<h3>1. 目标</h3>
<p>本例模拟中将集成Kafka与Flink：Flink实时从Kafka中获取消息，每隔10秒去统计机器当前可用的内存数并将结果写入到本地文件中。</p>
<h3>&nbsp;2. 环境准备</h3>
<ul>
<li>Apache Kafka 0.11.0.0</li>
<li>Apache Flink 1.3.1</li>
<li>Gradle 3.5 （版本号不是强要求）</li>
</ul>
<p>本例运行在Windows环境，但可以很容易地移植到其他平台上。</p>
<h3>3. 创建Flink Streaming工程</h3>
<p>本例使用Intellij IDEA作为项目开发的IDE。首先创建Gradle project，group为'huxihx.flink.demo'，artifact id为‘flink-kafka-demo’，version为‘1.0-SNAPSHOT’。整个项目结构如图所示：</p>
<p><img src="./Kafka与Flink集成 - huxihx - 博客园_files/735367-20170723184435080-1609686829.png" alt=""></p>
<h3>4. 增加kafka和kafka-connector依赖</h3>
<p>增加下列gradle依赖：</p>
<div class="cnblogs_Highlighter sh-gutter">
<div><div id="highlighter_75180" class="syntaxhighlighter  groovy"><div class="toolbar"><span><a href="https://www.cnblogs.com/huxi2b/p/7219792.html#" class="toolbar_item command_help help" target="_blank" rel="noopener">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="groovy plain">compile group: </code><code class="groovy string">'org.apache.flink'</code><code class="groovy plain">, name: </code><code class="groovy string">'flink-connector-kafka-0.10_2.11'</code><code class="groovy plain">, version: </code><code class="groovy string">'1.3.1'</code></div><div class="line number2 index1 alt1"><code class="groovy plain">compile group: </code><code class="groovy string">'org.apache.flink'</code><code class="groovy plain">, name: </code><code class="groovy string">'flink-streaming-java_2.11'</code><code class="groovy plain">, version: </code><code class="groovy string">'1.3.1'</code></div><div class="line number3 index2 alt2"><code class="groovy plain">compile group: </code><code class="groovy string">'org.apache.kafka'</code><code class="groovy plain">, name: </code><code class="groovy string">'kafka-clients'</code><code class="groovy plain">, version: </code><code class="groovy string">'0.11.0.0'</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>设置gradle打包依赖</p>
<div class="cnblogs_Highlighter sh-gutter">
<div><div id="highlighter_580659" class="syntaxhighlighter  groovy"><div class="toolbar"><span><a href="https://www.cnblogs.com/huxi2b/p/7219792.html#" class="toolbar_item command_help help" target="_blank" rel="noopener">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="groovy plain">jar {</code></div><div class="line number2 index1 alt1"><code class="groovy spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="groovy plain">manifest {</code></div><div class="line number3 index2 alt2"><code class="groovy spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="groovy plain">attributes(</code></div><div class="line number4 index3 alt1"><code class="groovy spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="groovy string">"Manifest-Version"</code><code class="groovy plain">: </code><code class="groovy value">1.0</code><code class="groovy plain">,</code></div><div class="line number5 index4 alt2"><code class="groovy spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="groovy string">"Main-Class"</code><code class="groovy plain">: </code><code class="groovy string">"huxihx.KafkaMessageStreaming"</code><code class="groovy plain">)</code></div><div class="line number6 index5 alt1"><code class="groovy spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="groovy plain">}</code></div><div class="line number7 index6 alt2"><code class="groovy spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="groovy plain">from { configurations.compile.</code><code class="groovy functions">collect</code> <code class="groovy plain">{ it.isDirectory() ? it : zipTree(it) } }</code></div><div class="line number8 index7 alt1"><code class="groovy spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="groovy plain">into(</code><code class="groovy string">'assets'</code><code class="groovy plain">) {</code></div><div class="line number9 index8 alt2"><code class="groovy spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="groovy plain">from </code><code class="groovy string">'assets'</code></div><div class="line number10 index9 alt1"><code class="groovy spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="groovy plain">}</code></div><div class="line number11 index10 alt2"><code class="groovy plain">}</code></div></div></td></tr></tbody></table></div></div>
</div>
<h3>5. 启动Flink环境（本例使用local测试环境）</h3>
<div class="cnblogs_code">
<pre>F:\SourceCode\flink-<span style="color: #800080;">1.3</span>.<span style="color: #800080;">1</span><span style="color: #000000;">
&gt; bin\start</span>-<span style="color: #000000;">local.bat
Starting Flink job manager. Webinterface by default on http:</span><span style="color: #008000;">//</span><span style="color: #008000;">localhost:8081/.</span>
Don<span style="color: #800000;">'</span><span style="color: #800000;">t close this batch window. Stop job manager by pressing Ctrl+C.</span></pre>
</div>
<h3>6. 启动Kafka单节点集群</h3>
<p>启动Zookeeper：</p>
<div class="cnblogs_code">
<pre><span style="color: #000000;">cd F:\SourceCode\zookeeper
</span>&gt; bin\zkServer.cmd</pre>
</div>
<p>启动Kafka broker：</p>
<div class="cnblogs_code">
<pre>&gt;<span style="color: #000000;"> cd F:\SourceCode\kafka_1
</span>&gt; set JMX_PORT=<span style="color: #800080;">9999</span> 
&gt; bin\windows\kafka-server-start.bat F:\\SourceCode\\configs\\server.properties</pre>
</div>
<h3>7. 代码开发</h3>
<p>代码主要由两部分组成：</p>
<ul>
<li>MessageSplitter类、MessageWaterEmitter类和KafkaMessageStreaming类：Flink streaming实时处理Kafka消息类</li>
<li>KafkaProducerTest类和MemoryUsageExtrator类：构建Kafka测试消息</li>
</ul>
<p>本例中，Kafka消息格式固定为：时间戳,主机名,当前可用内存数。其中主机名固定设置为machine-1，而时间戳和当前可用内存数都是动态获取。由于本例只会启动一个Kafka producer来模拟单台机器发来的消息，因此在最终的统计结果中只会统计machine-1这一台机器的内存。下面我们先来看flink部分的代码实现。</p>
<p><strong>MessageSplitter类（将获取到的每条Kafka消息根据“，”分割取出其中的主机名和内存数信息）</strong></p>
<div class="cnblogs_code"><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码" target="_blank" rel="noopener"><img src="./Kafka与Flink集成 - huxihx - 博客园_files/copycode.gif" alt="复制代码"></a></span></div>
<pre><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> MessageSplitter <span style="color: #0000ff;">implements</span> FlatMapFunction&lt;String, Tuple2&lt;String, Long&gt;&gt;<span style="color: #000000;"> {

    @Override
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> flatMap(String value, Collector&lt;Tuple2&lt;String, Long&gt;&gt; out) <span style="color: #0000ff;">throws</span><span style="color: #000000;"> Exception {
        </span><span style="color: #0000ff;">if</span> (value != <span style="color: #0000ff;">null</span> &amp;&amp; value.contains(","<span style="color: #000000;">)) {
            String[] parts </span>= value.split(","<span style="color: #000000;">);
            out.collect(</span><span style="color: #0000ff;">new</span> Tuple2&lt;&gt;(parts[1], Long.parseLong(parts[2<span style="color: #000000;">])));
        }
    }
}</span></pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码" target="_blank" rel="noopener"><img src="./Kafka与Flink集成 - huxihx - 博客园_files/copycode.gif" alt="复制代码"></a></span></div></div>
<p><strong>MessageWaterEmitter类（根据Kafka消息确定Flink的水位）</strong></p>
<div class="cnblogs_code"><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码" target="_blank" rel="noopener"><img src="./Kafka与Flink集成 - huxihx - 博客园_files/copycode.gif" alt="复制代码"></a></span></div>
<pre><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> MessageWaterEmitter <span style="color: #0000ff;">implements</span> AssignerWithPunctuatedWatermarks&lt;String&gt;<span style="color: #000000;"> {
    @Nullable
    @Override
    </span><span style="color: #0000ff;">public</span> Watermark checkAndGetNextWatermark(String lastElement, <span style="color: #0000ff;">long</span><span style="color: #000000;"> extractedTimestamp) {
        </span><span style="color: #0000ff;">if</span> (lastElement != <span style="color: #0000ff;">null</span> &amp;&amp; lastElement.contains(","<span style="color: #000000;">)) {
            String[] parts </span>= lastElement.split(","<span style="color: #000000;">);
            </span><span style="color: #0000ff;">return</span> <span style="color: #0000ff;">new</span> Watermark(Long.parseLong(parts[0<span style="color: #000000;">]));
        }
        </span><span style="color: #0000ff;">return</span> <span style="color: #0000ff;">null</span><span style="color: #000000;">;
    }

    @Override
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">long</span> extractTimestamp(String element, <span style="color: #0000ff;">long</span><span style="color: #000000;"> previousElementTimestamp) {
        </span><span style="color: #0000ff;">if</span> (element != <span style="color: #0000ff;">null</span> &amp;&amp; element.contains(","<span style="color: #000000;">)) {
            String[] parts </span>= element.split(","<span style="color: #000000;">);
            </span><span style="color: #0000ff;">return</span> Long.parseLong(parts[0<span style="color: #000000;">]);
        }
        </span><span style="color: #0000ff;">return</span> 0L<span style="color: #000000;">;
    }
}</span></pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码" target="_blank" rel="noopener"><img src="./Kafka与Flink集成 - huxihx - 博客园_files/copycode.gif" alt="复制代码"></a></span></div></div>
<p><strong>KafkaMessageStreaming类（Flink入口类，封装了对于Kafka消息的处理逻辑。本例每10秒统计一次结果并写入到本地文件）</strong></p>
<div class="cnblogs_code"><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码" target="_blank" rel="noopener"><img src="./Kafka与Flink集成 - huxihx - 博客园_files/copycode.gif" alt="复制代码"></a></span></div>
<pre><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> KafkaMessageStreaming {

    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> main(String[] args) <span style="color: #0000ff;">throws</span><span style="color: #000000;"> Exception {
        </span><span style="color: #0000ff;">final</span> StreamExecutionEnvironment env =<span style="color: #000000;"> StreamExecutionEnvironment.getExecutionEnvironment();
        env.enableCheckpointing(</span>5000<span style="color: #000000;">); // <span style="color: #ff0000;"><strong>非常关键，一定要设置启动检查点！！</strong></span>
        env.setStreamTimeCharacteristic(TimeCharacteristic.EventTime);

        Properties props </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> Properties();
        props.setProperty(</span>"bootstrap.servers", "localhost:9092"<span style="color: #000000;">);
        props.setProperty(</span>"group.id", "flink-group"<span style="color: #000000;">);

        FlinkKafkaConsumer010</span>&lt;String&gt; consumer =
                <span style="color: #0000ff;">new</span> FlinkKafkaConsumer010&lt;&gt;(args[0], <span style="color: #0000ff;">new</span><span style="color: #000000;"> SimpleStringSchema(), props);
        consumer.assignTimestampsAndWatermarks(</span><span style="color: #0000ff;">new</span><span style="color: #000000;"> MessageWaterEmitter());

        DataStream</span>&lt;Tuple2&lt;String, Long&gt;&gt; keyedStream =<span style="color: #000000;"> env
                .addSource(consumer)
                .flatMap(</span><span style="color: #0000ff;">new</span><span style="color: #000000;"> MessageSplitter())
                .keyBy(</span>0<span style="color: #000000;">)
                .timeWindow(Time.seconds(</span>10<span style="color: #000000;">))

                .apply(</span><span style="color: #0000ff;">new</span> WindowFunction&lt;Tuple2&lt;String, Long&gt;, Tuple2&lt;String, Long&gt;, Tuple, TimeWindow&gt;<span style="color: #000000;">() {
                    @Override
                    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> apply(Tuple tuple, TimeWindow window, Iterable&lt;Tuple2&lt;String, Long&gt;&gt; input, Collector&lt;Tuple2&lt;String, Long&gt;&gt; out) <span style="color: #0000ff;">throws</span><span style="color: #000000;"> Exception {
                        </span><span style="color: #0000ff;">long</span> sum = 0L<span style="color: #000000;">;
                        </span><span style="color: #0000ff;">int</span> count = 0<span style="color: #000000;">;
                        </span><span style="color: #0000ff;">for</span> (Tuple2&lt;String, Long&gt;<span style="color: #000000;"> record: input) {
                            sum </span>+=<span style="color: #000000;"> record.f1;
                            count</span>++<span style="color: #000000;">;
                        }
                        Tuple2</span>&lt;String, Long&gt; result =<span style="color: #000000;"> input.iterator().next();
                        result.f1 </span>= sum /<span style="color: #000000;"> count;
                        out.collect(result);
                    }
                });

        keyedStream.writeAsText(args[</span>1<span style="color: #000000;">]);
        env.execute(</span>"Flink-Kafka demo"<span style="color: #000000;">);
    }
}</span></pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码" target="_blank" rel="noopener"><img src="./Kafka与Flink集成 - huxihx - 博客园_files/copycode.gif" alt="复制代码"></a></span></div></div>
<p>实现了这些代码之后我们已然可以打包进行部署了，不过在其之前我们先看下Kafka producer测试类的实现——该类每1秒发送一条符合上面格式的Kafka消息供下游Flink集群消费。</p>
<p><strong>MemoryUsageExtrator类（很简单的工具类，提取当前可用内存字节数）</strong></p>
<div class="cnblogs_code"><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码" target="_blank" rel="noopener"><img src="./Kafka与Flink集成 - huxihx - 博客园_files/copycode.gif" alt="复制代码"></a></span></div>
<pre><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> MemoryUsageExtrator {

    </span><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> OperatingSystemMXBean mxBean =<span style="color: #000000;">
            (OperatingSystemMXBean) ManagementFactory.getOperatingSystemMXBean();

    </span><span style="color: #008000;">/**</span><span style="color: #008000;">
     * Get current free memory size in bytes
     * </span><span style="color: #808080;">@return</span><span style="color: #008000;">  free RAM size
     </span><span style="color: #008000;">*/</span>
    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">long</span><span style="color: #000000;"> currentFreeMemorySizeInBytes() {
        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> mxBean.getFreePhysicalMemorySize();
    }
}</span></pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码" target="_blank" rel="noopener"><img src="./Kafka与Flink集成 - huxihx - 博客园_files/copycode.gif" alt="复制代码"></a></span></div></div>
<p>KafkaProducerTest类（发送Kafka消息）</p>
<div class="cnblogs_code"><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码" target="_blank" rel="noopener"><img src="./Kafka与Flink集成 - huxihx - 博客园_files/copycode.gif" alt="复制代码"></a></span></div>
<pre><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> KafkaProducerTest {

    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> main(String[] args) <span style="color: #0000ff;">throws</span><span style="color: #000000;"> Exception {
        Properties props </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> Properties();
        props.put(</span>"bootstrap.servers", "localhost:9092"<span style="color: #000000;">);
        props.put(</span>"acks", "all"<span style="color: #000000;">);
        props.put(</span>"retries", 0<span style="color: #000000;">);
        props.put(</span>"batch.size", 16384<span style="color: #000000;">);
        props.put(</span>"linger.ms", 1<span style="color: #000000;">);
        props.put(</span>"buffer.memory", 33554432<span style="color: #000000;">);
        props.put(</span>"key.serializer", "org.apache.kafka.common.serialization.StringSerializer"<span style="color: #000000;">);
        props.put(</span>"value.serializer", "org.apache.kafka.common.serialization.StringSerializer"<span style="color: #000000;">);

        Producer</span>&lt;String, String&gt; producer = <span style="color: #0000ff;">new</span> KafkaProducer&lt;&gt;<span style="color: #000000;">(props);
        </span><span style="color: #0000ff;">int</span> totalMessageCount = 10000<span style="color: #000000;">;
        </span><span style="color: #0000ff;">for</span> (<span style="color: #0000ff;">int</span> i = 0; i &lt; totalMessageCount; i++<span style="color: #000000;">) {
            String value </span>= String.format("%d,%s,%d", System.currentTimeMillis(), "machine-1"<span style="color: #000000;">, currentMemSize());
            producer.send(</span><span style="color: #0000ff;">new</span> ProducerRecord&lt;&gt;("test", value), <span style="color: #0000ff;">new</span><span style="color: #000000;"> Callback() {
                @Override
                </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> onCompletion(RecordMetadata metadata, Exception exception) {
                    </span><span style="color: #0000ff;">if</span> (exception != <span style="color: #0000ff;">null</span><span style="color: #000000;">) {
                        System.out.println(</span>"Failed to send message with exception " +<span style="color: #000000;"> exception);
                    }
                }
            });
            Thread.sleep(</span>1000L<span style="color: #000000;">);
        }
        producer.close();
    }

    </span><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">long</span><span style="color: #000000;"> currentMemSize() {
        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> MemoryUsageExtrator.currentFreeMemorySizeInBytes();
    }
}</span></pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码" target="_blank" rel="noopener"><img src="./Kafka与Flink集成 - huxihx - 博客园_files/copycode.gif" alt="复制代码"></a></span></div></div>
<h3>8. 部署Flink jar包</h3>
<p><strong>8.1 打包Flink jar包</strong></p>
<div class="cnblogs_Highlighter sh-gutter">
<div><div id="highlighter_699611" class="syntaxhighlighter  groovy"><div class="toolbar"><span><a href="https://www.cnblogs.com/huxi2b/p/7219792.html#" class="toolbar_item command_help help" target="_blank" rel="noopener">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="groovy plain">&gt; cd flink-kafka-demo</code></div><div class="line number2 index1 alt1"><code class="groovy plain">&gt; gradle clean build</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>生成的jar包在项目目录下的build/libs/下，本例中是flink-kafka-demo-1.0-SNAPSHOT.jar</p>
<p><strong>8.2 部署jar包</strong></p>
<div class="cnblogs_Highlighter sh-gutter">
<div><div id="highlighter_464020" class="syntaxhighlighter  groovy"><div class="toolbar"><span><a href="https://www.cnblogs.com/huxi2b/p/7219792.html#" class="toolbar_item command_help help" target="_blank" rel="noopener">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="groovy plain">&gt; bin\flink.bat run -c huxihx.KafkaMessageStreaming&nbsp; F:\\Projects\\flink-kafka-demo\\build\\libs\\flink-kafka-demo-</code><code class="groovy value">1.0</code><code class="groovy plain">-SNAPSHOT.jar test F:\\temp\result.txt　　</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>KafkaMessageStreaming类接收两个命令行参数，第一个是Kafka topic名字，第二个是输出文件路径</p>
<p>部署成功之后，可以在Flink控制台(本例中是http://localhost:8081/)中看到job已成功部署，如下图所示：</p>
<p><img src="./Kafka与Flink集成 - huxihx - 博客园_files/735367-20170723194509252-1922184474.png" alt=""></p>
<h3>8. 运行KafkaProducerTest</h3>
<p>运行Kafka producer，给Flink job创建输入数据，然后启动一个终端，监控输出文件的变化，</p>
<div class="cnblogs_code"><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码" target="_blank" rel="noopener"><img src="./Kafka与Flink集成 - huxihx - 博客园_files/copycode.gif" alt="复制代码"></a></span></div>
<pre>&gt;<span style="color: #000000;"> cd F:\temp
</span>&gt; <span style="color: #0000ff;">tail</span> -<span style="color: #000000;">f result.txt
(machine</span>-<span style="color: #800080;">1</span>,<span style="color: #800080;">3942129078</span><span style="color: #000000;">)
(machine</span>-<span style="color: #800080;">1</span>,<span style="color: #800080;">3934864179</span><span style="color: #000000;">)
(machine</span>-<span style="color: #800080;">1</span>,<span style="color: #800080;">4044071321</span><span style="color: #000000;">)
(machine</span>-<span style="color: #800080;">1</span>,<span style="color: #800080;">4091437056</span><span style="color: #000000;">)
(machine</span>-<span style="color: #800080;">1</span>,<span style="color: #800080;">3925701836</span><span style="color: #000000;">)
(machine</span>-<span style="color: #800080;">1</span>,<span style="color: #800080;">3753678438</span><span style="color: #000000;">)
(machine</span>-<span style="color: #800080;">1</span>,<span style="color: #800080;">3746314649</span><span style="color: #000000;">)
......<br></span></pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码" target="_blank" rel="noopener"><img src="./Kafka与Flink集成 - huxihx - 博客园_files/copycode.gif" alt="复制代码"></a></span></div></div>
<p>可以看到，Flink每隔10s就会保存一条新的统计记录到result.txt文件中，该记录会统计主机名为machine-1的机器在过去10s的平均可用内存字节数。</p>
<h3>9. 总结</h3>
<p>&nbsp;本文给出了一个可运行的Flink + Kafka的项目配置及代码实现。值得注意的是，上面例子中用到的Flink Kafka connector使用了Kafka新版本consumer的API，因此不再需要连接Zookeeper信息。</p></div><div id="MySignature"></div>
<div class="clear"></div>
<div id="blog_post_info_block">
<div id="BlogPostCategory"></div>
<div id="EntryTag">标签: <a href="https://www.cnblogs.com/huxi2b/tag/Kafka/" target="_blank" rel="noopener">Kafka</a>, <a href="https://www.cnblogs.com/huxi2b/tag/Flink/" target="_blank" rel="noopener">Flink</a></div>
<div id="blog_post_info"><div id="green_channel">
        <a href="javascript:void(0);" id="green_channel_digg" onclick="DiggIt(7219792,cb_blogId,1);green_channel_success(this,&#39;谢谢推荐！&#39;);" target="_blank" rel="noopener">好文要顶</a>
            <a id="green_channel_follow" onclick="follow(&#39;193be0d2-09d2-e411-b908-9dcfd8948a71&#39;);" href="javascript:void(0);" target="_blank" rel="noopener">关注我</a>
    <a id="green_channel_favorite" onclick="AddToWz(cb_entryId);return false;" href="javascript:void(0);" target="_blank" rel="noopener">收藏该文</a>
    <a id="green_channel_weibo" href="javascript:void(0);" title="分享至新浪微博" onclick="ShareToTsina()" target="_blank" rel="noopener"><img src="./Kafka与Flink集成 - huxihx - 博客园_files/icon_weibo_24.png" alt=""></a>
    <a id="green_channel_wechat" href="javascript:void(0);" title="分享至微信" onclick="shareOnWechat()" target="_blank" rel="noopener"><img src="./Kafka与Flink集成 - huxihx - 博客园_files/wechat.png" alt=""></a>
</div>
<div id="author_profile">
    <div id="author_profile_info" class="author_profile_info">
            <a href="http://home.cnblogs.com/u/huxi2b/" target="_blank"><img src="./Kafka与Flink集成 - huxihx - 博客园_files/20161202114805.png" class="author_avatar" alt=""></a>
        <div id="author_profile_detail" class="author_profile_info">
            <a href="http://home.cnblogs.com/u/huxi2b/" target="_blank" rel="noopener">huxihx</a><br>
            <a href="http://home.cnblogs.com/u/huxi2b/followees" target="_blank" rel="noopener">关注 - 0</a><br>
            <a href="http://home.cnblogs.com/u/huxi2b/followers" target="_blank" rel="noopener">粉丝 - 237</a>
        </div>
    </div>
    <div class="clear"></div>
    <div id="author_profile_honor"></div>
    <div id="author_profile_follow">
                <a href="javascript:void(0);" onclick="follow(&#39;193be0d2-09d2-e411-b908-9dcfd8948a71&#39;);return false;" target="_blank" rel="noopener">+加关注</a>
    </div>
</div>
<div id="div_digg">
    <div class="diggit" onclick="votePost(7219792,&#39;Digg&#39;)">
        <span class="diggnum" id="digg_count">2</span>
    </div>
    <div class="buryit" onclick="votePost(7219792,&#39;Bury&#39;)">
        <span class="burynum" id="bury_count">0</span>
    </div>
    <div class="clear"></div>
    <div class="diggword" id="digg_tips">
    </div>
</div>
<script type="text/javascript">
    currentDiggType = 0;
</script></div>
<div class="clear"></div>
<div id="post_next_prev"><a href="https://www.cnblogs.com/huxi2b/p/7183219.html" class="p_n_p_prefix" target="_blank" rel="noopener">« </a> 上一篇：<a href="https://www.cnblogs.com/huxi2b/p/7183219.html" title="发布于2017-07-15 16:12" target="_blank" rel="noopener">Kafka 0.11客户端集群管理工具AdminClient</a><br><a href="https://www.cnblogs.com/huxi2b/p/7284767.html" class="p_n_p_prefix" target="_blank" rel="noopener">» </a> 下一篇：<a href="https://www.cnblogs.com/huxi2b/p/7284767.html" title="发布于2017-08-04 14:56" target="_blank" rel="noopener">Kafka consumer group位移重设</a><br></div>
</div>


		</div>
		<div class="postDesc">posted @ <span id="post-date">2017-07-23 19:52</span> <a href="https://www.cnblogs.com/huxi2b/" target="_blank" rel="noopener">huxihx</a> 阅读(<span id="post_view_count">13600</span>) 评论(<span id="post_comment_count">15</span>)  <a href="https://i.cnblogs.com/EditPosts.aspx?postid=7219792" rel="noopener" target="_blank">编辑</a> <a href="https://www.cnblogs.com/huxi2b/p/7219792.html#" onclick="AddToWz(7219792);return false;" target="_blank" rel="noopener">收藏</a></div>
	</div>
	<script type="text/javascript">var allowComments=true,cb_blogId=219719,cb_entryId=7219792,cb_blogApp=currentBlogApp,cb_blogUserGuid='193be0d2-09d2-e411-b908-9dcfd8948a71',cb_entryCreatedDate='2017/7/23 19:52:00';loadViewCount(cb_entryId);var cb_postType=1;var isMarkdown=false;</script>
	
</div><!--end: topics 文章、评论容器-->
</div><a name="!comments"></a><div id="blog-comments-placeholder"><div id="comments_pager_top"></div>
<!--done-->
<div class="feedback_area_title">评论列表</div>
<div class="feedbackNoItems"></div>
	

		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="https://www.cnblogs.com/huxi2b/p/7219792.html#3826343" class="layer" target="_blank" rel="noopener">#1楼</a><a name="3826343" id="comment_anchor_3826343"></a>  <span class="comment_date">2017-10-30 22:50</span> <a id="a_comment_author_3826343" href="https://www.cnblogs.com/yonglongzhou/" target="_blank">abcdefgzyl</a> <a href="http://msg.cnblogs.com/send/abcdefgzyl" title="发送站内短消息" class="sendMsg2This" target="_blank" rel="noopener">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3826343" class="blog_comment_body">请问一下有没有关于本篇文章完整的源代码</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3826343,&#39;Digg&#39;,this)" target="_blank" rel="noopener">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3826343,&#39;Bury&#39;,this)" target="_blank" rel="noopener">反对(0)</a></div>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="https://www.cnblogs.com/huxi2b/p/7219792.html#3826454" class="layer" target="_blank" rel="noopener">#2楼</a><a name="3826454" id="comment_anchor_3826454"></a>[<span class="louzhu">楼主</span>]  <span class="comment_date">2017-10-31 08:58</span> <a id="a_comment_author_3826454" href="https://www.cnblogs.com/huxi2b/" target="_blank">huxihx</a> <a href="http://msg.cnblogs.com/send/huxihx" title="发送站内短消息" class="sendMsg2This" target="_blank" rel="noopener">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3826454" class="blog_comment_body"><a href="https://www.cnblogs.com/huxi2b/p/7219792.html#3826343" title="查看所回复的评论" onclick="commentManager.renderComments(0,50,3826343);" target="_blank" rel="noopener">@</a>
abcdefgzyl<br>这些代码应该就是可以运行的~</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3826454,&#39;Digg&#39;,this)" target="_blank" rel="noopener">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3826454,&#39;Bury&#39;,this)" target="_blank" rel="noopener">反对(0)</a></div><span id="comment_3826454_avatar" style="display:none;">http://pic.cnblogs.com/face/735367/20161202114805.png</span>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="https://www.cnblogs.com/huxi2b/p/7219792.html#3867439" class="layer" target="_blank" rel="noopener">#3楼</a><a name="3867439" id="comment_anchor_3867439"></a>  <span class="comment_date">2017-12-17 03:21</span> <a id="a_comment_author_3867439" href="https://www.cnblogs.com/meyer_net/" target="_blank">遇见未知的自己</a> <a href="http://msg.cnblogs.com/send/%E9%81%87%E8%A7%81%E6%9C%AA%E7%9F%A5%E7%9A%84%E8%87%AA%E5%B7%B1" title="发送站内短消息" class="sendMsg2This" target="_blank" rel="noopener">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3867439" class="blog_comment_body">尝试把代码导入了 项目，只是不知道为什么，并没有输出日志，也没有报错。</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3867439,&#39;Digg&#39;,this)" target="_blank" rel="noopener">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3867439,&#39;Bury&#39;,this)" target="_blank" rel="noopener">反对(0)</a></div>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="https://www.cnblogs.com/huxi2b/p/7219792.html#3867857" class="layer" target="_blank" rel="noopener">#4楼</a><a name="3867857" id="comment_anchor_3867857"></a>[<span class="louzhu">楼主</span>]  <span class="comment_date">2017-12-18 08:30</span> <a id="a_comment_author_3867857" href="https://www.cnblogs.com/huxi2b/" target="_blank">huxihx</a> <a href="http://msg.cnblogs.com/send/huxihx" title="发送站内短消息" class="sendMsg2This" target="_blank" rel="noopener">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3867857" class="blog_comment_body"><a href="https://www.cnblogs.com/huxi2b/p/7219792.html#3867439" title="查看所回复的评论" onclick="commentManager.renderComments(0,50,3867439);" target="_blank" rel="noopener">@</a>
遇见未知的自己<br>这个程序的结果是写到输出文件中的，就是运行命令时指定的那个输出文件。</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3867857,&#39;Digg&#39;,this)" target="_blank" rel="noopener">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3867857,&#39;Bury&#39;,this)" target="_blank" rel="noopener">反对(0)</a></div><span id="comment_3867857_avatar" style="display:none;">http://pic.cnblogs.com/face/735367/20161202114805.png</span>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="https://www.cnblogs.com/huxi2b/p/7219792.html#3867935" class="layer" target="_blank" rel="noopener">#5楼</a><a name="3867935" id="comment_anchor_3867935"></a>  <span class="comment_date">2017-12-18 09:45</span> <a id="a_comment_author_3867935" href="https://www.cnblogs.com/meyer_net/" target="_blank">遇见未知的自己</a> <a href="http://msg.cnblogs.com/send/%E9%81%87%E8%A7%81%E6%9C%AA%E7%9F%A5%E7%9A%84%E8%87%AA%E5%B7%B1" title="发送站内短消息" class="sendMsg2This" target="_blank" rel="noopener">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3867935" class="blog_comment_body">@huxihx 嗯，主要是，没看见报错，指定的 “F:\\temp\result.txt”下，并没产生日志文件。所以纳闷。</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3867935,&#39;Digg&#39;,this)" target="_blank" rel="noopener">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3867935,&#39;Bury&#39;,this)" target="_blank" rel="noopener">反对(0)</a></div>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="https://www.cnblogs.com/huxi2b/p/7219792.html#3950521" class="layer" target="_blank" rel="noopener">#6楼</a><a name="3950521" id="comment_anchor_3950521"></a>  <span class="comment_date">2018-04-13 10:20</span> <a id="a_comment_author_3950521" href="https://www.cnblogs.com/andylulu/" target="_blank">小王旺</a> <a href="http://msg.cnblogs.com/send/%E5%B0%8F%E7%8E%8B%E6%97%BA" title="发送站内短消息" class="sendMsg2This" target="_blank" rel="noopener">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3950521" class="blog_comment_body">public class MessageSplitter implements FlatMapFunction&lt;String, Tuple2&lt;String, Long&gt;&gt; {<br><br>    @Override<br>    public void flatMap(String value, Collector&lt;Tuple2&lt;String, Long&gt;&gt; out) throws Exception {<br>        if (value != null &amp;&amp; value.contains(",")) {<br>            String[] parts = value.split(",");<br>            out.collect(new Tuple2&lt;&gt;(parts[1], Long.parseLong(parts[2])));<br>        }<br>    }<br>}<br><br>问下 这个里面的 Collector&lt;Tuple2&lt;String, Long&gt;&gt;   来自哪里？</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3950521,&#39;Digg&#39;,this)" target="_blank" rel="noopener">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3950521,&#39;Bury&#39;,this)" target="_blank" rel="noopener">反对(0)</a></div>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="https://www.cnblogs.com/huxi2b/p/7219792.html#3950537" class="layer" target="_blank" rel="noopener">#7楼</a><a name="3950537" id="comment_anchor_3950537"></a>[<span class="louzhu">楼主</span>]  <span class="comment_date">2018-04-13 10:28</span> <a id="a_comment_author_3950537" href="https://www.cnblogs.com/huxi2b/" target="_blank">huxihx</a> <a href="http://msg.cnblogs.com/send/huxihx" title="发送站内短消息" class="sendMsg2This" target="_blank" rel="noopener">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3950537" class="blog_comment_body"><a href="https://www.cnblogs.com/huxi2b/p/7219792.html#3950521" title="查看所回复的评论" onclick="commentManager.renderComments(0,50,3950521);" target="_blank" rel="noopener">@</a>
小王旺<br>Flink中FlatMapFunction的apply方法签名是：<br>void flatMap(T value, Collector&lt;O&gt; out) throws Exception;<br>里面的O就是本例中的Tuple2&lt;String, Long&gt;，String是机器名，Long是内存字节数。<br><br>实际上本例使用MapFunction也可以</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3950537,&#39;Digg&#39;,this)" target="_blank" rel="noopener">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3950537,&#39;Bury&#39;,this)" target="_blank" rel="noopener">反对(0)</a></div><span id="comment_3950537_avatar" style="display:none;">http://pic.cnblogs.com/face/735367/20161202114805.png</span>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="https://www.cnblogs.com/huxi2b/p/7219792.html#3950748" class="layer" target="_blank" rel="noopener">#8楼</a><a name="3950748" id="comment_anchor_3950748"></a>  <span class="comment_date">2018-04-13 14:39</span> <a id="a_comment_author_3950748" href="https://www.cnblogs.com/andylulu/" target="_blank">小王旺</a> <a href="http://msg.cnblogs.com/send/%E5%B0%8F%E7%8E%8B%E6%97%BA" title="发送站内短消息" class="sendMsg2This" target="_blank" rel="noopener">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3950748" class="blog_comment_body"><a href="https://www.cnblogs.com/huxi2b/p/7219792.html#3950537" title="查看所回复的评论" onclick="commentManager.renderComments(0,50,3950537);" target="_blank" rel="noopener">@</a>
huxihx<br>非常感谢！明白了  还有一个问题是 最后的KafkaProducerTest 和 MemoryUsageExtrator 是一起打包到flink-kafka-demo-1.0-SNAPSHOT.jar里面么？不太明白怎么发KafkaProducerTest ？</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3950748,&#39;Digg&#39;,this)" target="_blank" rel="noopener">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3950748,&#39;Bury&#39;,this)" target="_blank" rel="noopener">反对(0)</a></div>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="https://www.cnblogs.com/huxi2b/p/7219792.html#3950824" class="layer" target="_blank" rel="noopener">#9楼</a><a name="3950824" id="comment_anchor_3950824"></a>[<span class="louzhu">楼主</span>]  <span class="comment_date">2018-04-13 15:38</span> <a id="a_comment_author_3950824" href="https://www.cnblogs.com/huxi2b/" target="_blank">huxihx</a> <a href="http://msg.cnblogs.com/send/huxihx" title="发送站内短消息" class="sendMsg2This" target="_blank" rel="noopener">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3950824" class="blog_comment_body"><a href="https://www.cnblogs.com/huxi2b/p/7219792.html#3950748" title="查看所回复的评论" onclick="commentManager.renderComments(0,50,3950748);" target="_blank" rel="noopener">@</a>
小王旺<br>不需要，你只需要写个程序给kafka发送消息即可。放到哪里都可以</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3950824,&#39;Digg&#39;,this)" target="_blank" rel="noopener">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3950824,&#39;Bury&#39;,this)" target="_blank" rel="noopener">反对(0)</a></div><span id="comment_3950824_avatar" style="display:none;">http://pic.cnblogs.com/face/735367/20161202114805.png</span>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="https://www.cnblogs.com/huxi2b/p/7219792.html#3953582" class="layer" target="_blank" rel="noopener">#10楼</a><a name="3953582" id="comment_anchor_3953582"></a>[<span class="louzhu">楼主</span>]  <span class="comment_date">2018-04-17 10:46</span> <a id="a_comment_author_3953582" href="https://www.cnblogs.com/huxi2b/" target="_blank">huxihx</a> <a href="http://msg.cnblogs.com/send/huxihx" title="发送站内短消息" class="sendMsg2This" target="_blank" rel="noopener">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3953582" class="blog_comment_body"><a href="https://www.cnblogs.com/huxi2b/p/7219792.html#3953558" title="查看所回复的评论" onclick="commentManager.renderComments(0,50,3953558);" target="_blank" rel="noopener">@</a>
小王旺<br>可以先使用kafka-topics命令确认topic是正常工作的吧</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3953582,&#39;Digg&#39;,this)" target="_blank" rel="noopener">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3953582,&#39;Bury&#39;,this)" target="_blank" rel="noopener">反对(0)</a></div><span id="comment_3953582_avatar" style="display:none;">http://pic.cnblogs.com/face/735367/20161202114805.png</span>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="https://www.cnblogs.com/huxi2b/p/7219792.html#3953660" class="layer" target="_blank" rel="noopener">#11楼</a><a name="3953660" id="comment_anchor_3953660"></a>  <span class="comment_date">2018-04-17 11:43</span> <a id="a_comment_author_3953660" href="https://www.cnblogs.com/andylulu/" target="_blank">小王旺</a> <a href="http://msg.cnblogs.com/send/%E5%B0%8F%E7%8E%8B%E6%97%BA" title="发送站内短消息" class="sendMsg2This" target="_blank" rel="noopener">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3953660" class="blog_comment_body"><a href="https://www.cnblogs.com/huxi2b/p/7219792.html#3867439" title="查看所回复的评论" onclick="commentManager.renderComments(0,50,3867439);" target="_blank" rel="noopener">@</a>
遇见未知的自己<br>我现在跟你的情况一样 后来咋解决的？</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3953660,&#39;Digg&#39;,this)" target="_blank" rel="noopener">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3953660,&#39;Bury&#39;,this)" target="_blank" rel="noopener">反对(0)</a></div>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="https://www.cnblogs.com/huxi2b/p/7219792.html#3953902" class="layer" target="_blank" rel="noopener">#12楼</a><a name="3953902" id="comment_anchor_3953902"></a>  <span class="comment_date">2018-04-17 16:38</span> <a id="a_comment_author_3953902" href="https://www.cnblogs.com/andylulu/" target="_blank">小王旺</a> <a href="http://msg.cnblogs.com/send/%E5%B0%8F%E7%8E%8B%E6%97%BA" title="发送站内短消息" class="sendMsg2This" target="_blank" rel="noopener">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3953902" class="blog_comment_body"><a href="https://www.cnblogs.com/huxi2b/p/7219792.html#3953582" title="查看所回复的评论" onclick="commentManager.renderComments(0,50,3953582);" target="_blank" rel="noopener">@</a>
huxihx <br>kafka可以接收到测试类发过去的消息  flink上部署jar包启动也ok  但是result.txt并没有生成  这个怎么找原因？</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3953902,&#39;Digg&#39;,this)" target="_blank" rel="noopener">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3953902,&#39;Bury&#39;,this)" target="_blank" rel="noopener">反对(0)</a></div>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="https://www.cnblogs.com/huxi2b/p/7219792.html#3954325" class="layer" target="_blank" rel="noopener">#13楼</a><a name="3954325" id="comment_anchor_3954325"></a>[<span class="louzhu">楼主</span>]  <span class="comment_date">2018-04-18 08:33</span> <a id="a_comment_author_3954325" href="https://www.cnblogs.com/huxi2b/" target="_blank">huxihx</a> <a href="http://msg.cnblogs.com/send/huxihx" title="发送站内短消息" class="sendMsg2This" target="_blank" rel="noopener">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3954325" class="blog_comment_body"><a href="https://www.cnblogs.com/huxi2b/p/7219792.html#3953902" title="查看所回复的评论" onclick="commentManager.renderComments(0,50,3953902);" target="_blank" rel="noopener">@</a>
小王旺<br>你可以先使用kafka命令确认topic中的确是有数据的，然后再看为什么Flink没有能够处理之</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3954325,&#39;Digg&#39;,this)" target="_blank" rel="noopener">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3954325,&#39;Bury&#39;,this)" target="_blank" rel="noopener">反对(0)</a></div><span id="comment_3954325_avatar" style="display:none;">http://pic.cnblogs.com/face/735367/20161202114805.png</span>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="https://www.cnblogs.com/huxi2b/p/7219792.html#3954353" class="layer" target="_blank" rel="noopener">#14楼</a><a name="3954353" id="comment_anchor_3954353"></a>  <span class="comment_date">2018-04-18 09:24</span> <a id="a_comment_author_3954353" href="https://www.cnblogs.com/andylulu/" target="_blank">小王旺</a> <a href="http://msg.cnblogs.com/send/%E5%B0%8F%E7%8E%8B%E6%97%BA" title="发送站内短消息" class="sendMsg2This" target="_blank" rel="noopener">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3954353" class="blog_comment_body"><a href="https://www.cnblogs.com/huxi2b/p/7219792.html#3954325" title="查看所回复的评论" onclick="commentManager.renderComments(0,50,3954325);" target="_blank" rel="noopener">@</a>
huxihx<br>我确认topic中有数据  因为我用consumer命令可以消费对应的topic,现在可以确定是flink没有处理，这个在flink中怎么定位原因呢？求教<br><br>我重新在flink上部署一遍   指定同样的topic 文件生成路径  ，报错如下：<br>) -&gt; Sink: Unnamed(1/1) switched to FAILED <br>java.io.IOException: File or directory already exists. Existing files and directories are not overwritten in NO_OVERWRITE mode. Use OVERWRITE mode to overwrite existing files and directories.<br>        at org.apache.flink.core.fs.FileSystem.initOutPathLocalFS(FileSystem.java:757)<br>        at org.apache.flink.core.fs.SafetyNetWrapperFileSystem.initOutPathLocalFS(SafetyNetWrapperFileSystem.java:132)<br>        at org.apache.flink.api.common.io.FileOutputFormat.open(FileOutputFormat.java:231)<br>        at org.apache.flink.api.java.io.TextOutputFormat.open(TextOutputFormat.java:88)<br>        at org.apache.flink.streaming.api.functions.sink.OutputFormatSinkFunction.open(OutputFormatSinkFunction.java:61)<br>        at org.apache.flink.api.common.functions.util.FunctionUtils.openFunction(FunctionUtils.java:36)<br>        at org.apache.flink.streaming.api.operators.AbstractUdfStreamOperator.open(AbstractUdfStreamOperator.java:102)<br>        at org.apache.flink.streaming.api.operators.StreamSink.open(StreamSink.java:48)<br>        at org.apache.flink.streaming.runtime.tasks.StreamTask.openAllOperators(StreamTask.java:393)<br>        at org.apache.flink.streaming.runtime.tasks.StreamTask.invoke(StreamTask.java:254)<br>        at org.apache.flink.runtime.taskmanager.Task.run(Task.java:718)<br>        at java.lang.Thread.run(Thread.java:745)<br>说明 文件以及生成 但是我在对应文件夹下没有看到</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3954353,&#39;Digg&#39;,this)" target="_blank" rel="noopener">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3954353,&#39;Bury&#39;,this)" target="_blank" rel="noopener">反对(0)</a></div>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="https://www.cnblogs.com/huxi2b/p/7219792.html#3955011" class="layer" target="_blank" rel="noopener">#15楼</a><a name="3955011" id="comment_anchor_3955011"></a>[<span class="louzhu">楼主</span>]<span id="comment-maxId" style="display:none;">3955011</span><span id="comment-maxDate" style="display:none;">2018/4/18 20:12:32</span>  <span class="comment_date">2018-04-18 20:12</span> <a id="a_comment_author_3955011" href="https://www.cnblogs.com/huxi2b/" target="_blank">huxihx</a> <a href="http://msg.cnblogs.com/send/huxihx" title="发送站内短消息" class="sendMsg2This" target="_blank" rel="noopener">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3955011" class="blog_comment_body"><a href="https://www.cnblogs.com/huxi2b/p/7219792.html#3954353" title="查看所回复的评论" onclick="commentManager.renderComments(0,50,3954353);" target="_blank" rel="noopener">@</a>
小王旺<br>这不是提示了吗：File or directory already exists<br>换个全新的目录试试</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3955011,&#39;Digg&#39;,this)" target="_blank" rel="noopener">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3955011,&#39;Bury&#39;,this)" target="_blank" rel="noopener">反对(0)</a></div><span id="comment_3955011_avatar" style="display:none;">http://pic.cnblogs.com/face/735367/20161202114805.png</span>
			</div>
		</div>
	<div id="comments_pager_bottom"></div></div><script type="text/javascript">var commentManager = new blogCommentManager();commentManager.renderComments(0);</script>
<div id="comment_form" class="commentform">
<a name="commentform"></a>
<div id="divCommentShow"></div>
<div id="comment_nav"><span id="span_refresh_tips"></span><a href="javascript:void(0);" onclick="return RefreshCommentList();" id="lnk_RefreshComments" runat="server" clientidmode="Static" target="_blank" rel="noopener">刷新评论</a><a href="https://www.cnblogs.com/huxi2b/p/7219792.html#" onclick="return RefreshPage();" target="_blank" rel="noopener">刷新页面</a><a href="https://www.cnblogs.com/huxi2b/p/7219792.html#top" target="_blank" rel="noopener">返回顶部</a></div>
<div id="comment_form_container"><div class="login_tips">注册用户登录后才能发表评论，请 <a rel="noopener" href="javascript:void(0);" class="underline" onclick="return login(&#39;commentform&#39;);" target="_blank">登录</a> 或 <a rel="noopener" href="javascript:void(0);" class="underline" onclick="return register();" target="_blank">注册</a>，<a href="http://www.cnblogs.com/" target="_blank" rel="noopener">访问</a>网站首页。</div></div>
<div class="ad_text_commentbox" id="ad_text_under_commentbox"></div>
<div id="ad_t2"><a href="https://edu.51cto.com/activity/19.html?source=bky" target="_blank" onclick="ga(&#39;send&#39;, &#39;event&#39;, &#39;Link&#39;, &#39;click&#39;, &#39;T2-51CTO&#39;)">【幸运】99%的人不知道我们有可以帮你薪资翻倍的秘笈！</a><br><a href="http://www.ucancode.com/index.htm" target="_blank" onclick="ga(&#39;send&#39;, &#39;event&#39;, &#39;Link&#39;, &#39;click&#39;, &#39;T2-工控&#39;)">【推荐】超50万C++/C#源码: 大型实时仿真组态图形源码</a><br><a href="https://cloud.baidu.com/campaign/purchase-2019/index.html?track=cp:dsp|pf:pc|pp:chui-bokeyuan-huodong-19caigouji-BCC-neiyeCH-190311|pu:neiyeCH-wenzilian|ci:2019cgj|kw:2105959" target="_blank" onclick="ga(&#39;send&#39;, &#39;event&#39;, &#39;Link&#39;, &#39;click&#39;, &#39;T2-百度云&#39;)">【推荐】百度云“猪”你开年行大运，红包疯狂拿</a><br><a href="https://ke.qq.com/adActivity.html?name=xiangxueketang2" target="_blank" onclick="ga(&#39;send&#39;, &#39;event&#39;, &#39;Link&#39;, &#39;click&#39;, &#39;T2-享学&#39;)">【推荐】55K刚面完Java架构师岗，这些技术你必须掌握</a><br></div>
<div id="opt_under_post"></div>
<script async="async" src="./Kafka与Flink集成 - huxihx - 博客园_files/gpt.js"></script>
<script>
  var googletag = googletag || {};
  googletag.cmd = googletag.cmd || [];
</script>
<script>
  googletag.cmd.push(function() {
        googletag.defineSlot('/1090369/C1', [300, 250], 'div-gpt-ad-1546353474406-0').addService(googletag.pubads());
        googletag.defineSlot('/1090369/C2', [468, 60], 'div-gpt-ad-1539008685004-0').addService(googletag.pubads());
        googletag.pubads().enableSingleRequest();
        googletag.enableServices();
  });
</script>
<div id="cnblogs_c1" class="c_ad_block">
    <div id="div-gpt-ad-1546353474406-0" style="height:250px; width:300px;" data-google-query-id="CI7_2PWzieECFcM4lgodBZYE3Q"><div id="google_ads_iframe_/1090369/C1_0__container__" style="border: 0pt none;"><iframe id="google_ads_iframe_/1090369/C1_0" title="3rd party ad content" name="google_ads_iframe_/1090369/C1_0" width="300" height="250" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" style="border: 0px; vertical-align: bottom;" data-google-container-id="1" data-load-complete="true" src="./Kafka与Flink集成 - huxihx - 博客园_files/saved_resource.html"></iframe></div></div>
</div>
<div id="under_post_news"><div class="itnews c_ad_block"><b>相关博文：</b><br>·  <a href="https://www.cnblogs.com/moonandstar08/p/6052650.html" target="_blank" onclick="clickRecomItmem(6052650)">Flume与Kafka集成</a><br>·  <a href="https://www.cnblogs.com/wangb0402/p/6187796.html" target="_blank" onclick="clickRecomItmem(6187796)">kafka与Spring的集成</a><br>·  <a href="https://www.cnblogs.com/siran/p/10349003.html" target="_blank" onclick="clickRecomItmem(10349003)">Kafka与Spark的集成</a><br>·  <a href="https://www.cnblogs.com/WCFGROUP/p/9074852.html" target="_blank" onclick="clickRecomItmem(9074852)">FlinkKAFKA</a><br>·  <a href="https://www.cnblogs.com/zengnansheng/p/10389749.html" target="_blank" onclick="clickRecomItmem(10389749)">Kafka之与Spring集成</a><br></div></div>
<div id="cnblogs_c2" class="c_ad_block">
    <div id="div-gpt-ad-1539008685004-0" style="height:60px; width:468px;" data-google-query-id="CM7v2fWzieECFYk1lgodyWwNfg"><div id="google_ads_iframe_/1090369/C2_0__container__" style="border: 0pt none;"><iframe id="google_ads_iframe_/1090369/C2_0" title="3rd party ad content" name="google_ads_iframe_/1090369/C2_0" width="468" height="60" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" style="border: 0px; vertical-align: bottom;" data-google-container-id="2" data-load-complete="true" src="./Kafka与Flink集成 - huxihx - 博客园_files/saved_resource(1).html"></iframe></div></div>
</div>
<div id="under_post_kb"><div class="itnews c_ad_block"><b>最新新闻</b>：<br> ·  <a href="https://news.cnblogs.com/n/621968/" target="_blank">大学生利用白条漏洞骗走京东110万，还剩1年就毕业</a><br> ·  <a href="https://news.cnblogs.com/n/621967/" target="_blank">《Apex 英雄》成功背后，是EA的一次宣发实验</a><br> ·  <a href="https://news.cnblogs.com/n/621966/" target="_blank">量子实验暗示客观现实不存在</a><br> ·  <a href="https://news.cnblogs.com/n/621965/" target="_blank">百度发布NLP模型ERNIE，在多个中文NLP任务中表现超越BERT</a><br> ·  <a href="https://news.cnblogs.com/n/621964/" target="_blank">“疯狂”的超利贷，谁薅了谁的羊毛？</a><br>» <a href="http://news.cnblogs.com/" title="IT新闻" target="_blank">更多新闻...</a></div></div>
<div id="HistoryToday" class="c_ad_block"></div>
<script type="text/javascript">
 if(enablePostBottom()) {
    codeHighlight();
    fixPostBody();
    setTimeout(function () { incrementViewCount(cb_entryId); }, 50);
    deliverT2();
    deliverC1();
    deliverC2();    
    loadNewsAndKb();
    loadBlogSignature();
    LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);
    GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate, cb_postType);
    loadOptUnderPost();
    GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);  
}
</script>
</div>

    
	</div><!--end: forFlow -->
	</div><!--end: mainContent 主体内容容器-->

	<div id="sideBar">
		<div id="sideBarMain">
			
<!--done-->
<div class="newsItem">
<h3 class="catListTitle">公告</h3>
	<div id="blog-news"><img src="./Kafka与Flink集成 - huxihx - 博客园_files/qcode.bmp" height="100" width="100"><div id="profile_block">昵称：<a href="https://home.cnblogs.com/u/huxi2b/" target="_blank" rel="noopener">huxihx</a><br>园龄：<a href="https://home.cnblogs.com/u/huxi2b/" title="入园时间：2015-03-24" target="_blank" rel="noopener">3年11个月</a><br>粉丝：<a href="https://home.cnblogs.com/u/huxi2b/followers/" target="_blank" rel="noopener">237</a><br>关注：<a href="https://home.cnblogs.com/u/huxi2b/followees/" target="_blank" rel="noopener">0</a><div id="p_b_follow"><a href="javascript:void(0);" onclick="follow(&#39;193be0d2-09d2-e411-b908-9dcfd8948a71&#39;)" target="_blank" rel="noopener">+加关注</a></div><script>getFollowStatus('193be0d2-09d2-e411-b908-9dcfd8948a71')</script></div></div><script type="text/javascript">loadBlogNews();</script>
</div>

			<div id="calendar"><div id="blog-calendar" style=""><table id="blogCalendar" class="Cal" cellspacing="0" cellpadding="0" title="Calendar">
	<tbody><tr><td colspan="7"><table class="CalTitle" cellspacing="0">
		<tbody><tr><td class="CalNextPrev"><a href="javascript:void(0);" onclick="loadBlogCalendar(&#39;2019/02/01&#39;);return false;" target="_blank" rel="noopener">&lt;</a></td><td align="center">2019年3月</td><td class="CalNextPrev" align="right"><a href="javascript:void(0);" onclick="loadBlogCalendar(&#39;2019/04/01&#39;);return false;" target="_blank" rel="noopener">&gt;</a></td></tr>
	</tbody></table></td></tr><tr><th class="CalDayHeader" align="center" abbr="日" scope="col">日</th><th class="CalDayHeader" align="center" abbr="一" scope="col">一</th><th class="CalDayHeader" align="center" abbr="二" scope="col">二</th><th class="CalDayHeader" align="center" abbr="三" scope="col">三</th><th class="CalDayHeader" align="center" abbr="四" scope="col">四</th><th class="CalDayHeader" align="center" abbr="五" scope="col">五</th><th class="CalDayHeader" align="center" abbr="六" scope="col">六</th></tr><tr><td class="CalOtherMonthDay" align="center">24</td><td class="CalOtherMonthDay" align="center">25</td><td class="CalOtherMonthDay" align="center">26</td><td class="CalOtherMonthDay" align="center">27</td><td class="CalOtherMonthDay" align="center">28</td><td align="center">1</td><td class="CalWeekendDay" align="center">2</td></tr><tr><td class="CalWeekendDay" align="center">3</td><td align="center">4</td><td align="center">5</td><td align="center">6</td><td align="center">7</td><td align="center">8</td><td class="CalWeekendDay" align="center">9</td></tr><tr><td class="CalWeekendDay" align="center">10</td><td align="center">11</td><td align="center">12</td><td align="center">13</td><td align="center">14</td><td align="center"><a href="https://www.cnblogs.com/huxi2b/archive/2019/03/15.html" target="_blank" rel="noopener"><u>15</u></a></td><td class="CalWeekendDay" align="center">16</td></tr><tr><td class="CalTodayDay" align="center">17</td><td align="center">18</td><td align="center">19</td><td align="center">20</td><td align="center">21</td><td align="center">22</td><td class="CalWeekendDay" align="center">23</td></tr><tr><td class="CalWeekendDay" align="center">24</td><td align="center">25</td><td align="center">26</td><td align="center">27</td><td align="center">28</td><td align="center">29</td><td class="CalWeekendDay" align="center">30</td></tr><tr><td class="CalWeekendDay" align="center">31</td><td class="CalOtherMonthDay" align="center">1</td><td class="CalOtherMonthDay" align="center">2</td><td class="CalOtherMonthDay" align="center">3</td><td class="CalOtherMonthDay" align="center">4</td><td class="CalOtherMonthDay" align="center">5</td><td class="CalOtherMonthDay" align="center">6</td></tr>
</tbody></table></div><script type="text/javascript">loadBlogDefaultCalendar();</script></div>
			
			<div id="leftcontentcontainer">
				<div id="blog-sidecolumn"><div id="sidebar_search" class="sidebar-block">
<div id="sidebar_search" class="mySearch">
<h3 class="catListTitle">搜索</h3>
<div id="sidebar_search_box">
<div id="widget_my_zzk" class="div_my_zzk"><input type="text" id="q" onkeydown="return zzk_go_enter(event);" class="input_my_zzk">&nbsp;<input onclick="zzk_go()" type="button" value="找找看" id="btnZzk" class="btn_my_zzk"></div>
<div id="widget_my_google" class="div_my_zzk"><input type="text" name="google_q" id="google_q" onkeydown="return google_go_enter(event)" class="input_my_zzk">&nbsp;<input onclick="google_go()" type="button" value="谷歌搜索" class="btn_my_zzk"></div>
</div>
</div>

</div><div id="sidebar_shortcut" class="sidebar-block">
<div class="catListLink">
<h3 class="catListTitle">常用链接</h3>
<ul>
<li><a href="https://www.cnblogs.com/huxi2b/p/" title="我的博客的随笔列表" target="_blank" rel="noopener">我的随笔</a></li><li><a href="https://www.cnblogs.com/huxi2b/MyComments.html" title="我发表过的评论列表" target="_blank" rel="noopener">我的评论</a></li><li><a href="https://www.cnblogs.com/huxi2b/OtherPosts.html" title="我评论过的随笔列表" target="_blank" rel="noopener">我的参与</a></li><li><a href="https://www.cnblogs.com/huxi2b/RecentComments.html" title="我的博客的评论列表" target="_blank" rel="noopener">最新评论</a></li><li><a href="https://www.cnblogs.com/huxi2b/tag/" title="我的博客的标签列表" target="_blank" rel="noopener">我的标签</a></li>
</ul>
<div id="itemListLin_con" style="display:none;">
<ul>

</ul>
</div>
</div></div><div id="sidebar_toptags" class="sidebar-block">
<div class="catListTag">
<h3 class="catListTitle">我的标签</h3>
<ul>
<li><a href="https://www.cnblogs.com/huxi2b/tag/Kafka/" target="_blank" rel="noopener">Kafka</a>(82)</li><li><a href="https://www.cnblogs.com/huxi2b/tag/Flink/" target="_blank" rel="noopener">Flink</a>(6)</li><li><a href="https://www.cnblogs.com/huxi2b/tag/Kafka-consumer/" target="_blank" rel="noopener">Kafka-consumer</a>(5)</li><li><a href="https://www.cnblogs.com/huxi2b/tag/kafka-producer/" target="_blank" rel="noopener">kafka-producer</a>(4)</li><li><a href="https://www.cnblogs.com/huxi2b/tag/Streaming/" target="_blank" rel="noopener">Streaming</a>(3)</li><li><a href="https://www.cnblogs.com/huxi2b/tag/Paxos/" target="_blank" rel="noopener">Paxos</a>(1)</li>
</ul>
</div></div><div id="sidebar_categories">
<div class="catListPostArchive">
<h3 class="catListTitle">随笔档案</h3>

<ul>

<li><a id="CatList_LinkList_0_Link_0" href="https://www.cnblogs.com/huxi2b/archive/2019/03.html" target="_blank" rel="noopener">2019年3月 (1)</a> </li>

<li><a id="CatList_LinkList_0_Link_1" href="https://www.cnblogs.com/huxi2b/archive/2019/02.html" target="_blank" rel="noopener">2019年2月 (1)</a> </li>

<li><a id="CatList_LinkList_0_Link_2" href="https://www.cnblogs.com/huxi2b/archive/2019/01.html" target="_blank" rel="noopener">2019年1月 (3)</a> </li>

<li><a id="CatList_LinkList_0_Link_3" href="https://www.cnblogs.com/huxi2b/archive/2018/12.html" target="_blank" rel="noopener">2018年12月 (1)</a> </li>

<li><a id="CatList_LinkList_0_Link_4" href="https://www.cnblogs.com/huxi2b/archive/2018/11.html" target="_blank" rel="noopener">2018年11月 (1)</a> </li>

<li><a id="CatList_LinkList_0_Link_5" href="https://www.cnblogs.com/huxi2b/archive/2018/10.html" target="_blank" rel="noopener">2018年10月 (2)</a> </li>

<li><a id="CatList_LinkList_0_Link_6" href="https://www.cnblogs.com/huxi2b/archive/2018/09.html" target="_blank" rel="noopener">2018年9月 (1)</a> </li>

<li><a id="CatList_LinkList_0_Link_7" href="https://www.cnblogs.com/huxi2b/archive/2018/08.html" target="_blank" rel="noopener">2018年8月 (1)</a> </li>

<li><a id="CatList_LinkList_0_Link_8" href="https://www.cnblogs.com/huxi2b/archive/2018/07.html" target="_blank" rel="noopener">2018年7月 (1)</a> </li>

<li><a id="CatList_LinkList_0_Link_9" href="https://www.cnblogs.com/huxi2b/archive/2018/06.html" target="_blank" rel="noopener">2018年6月 (2)</a> </li>

<li><a id="CatList_LinkList_0_Link_10" href="https://www.cnblogs.com/huxi2b/archive/2018/05.html" target="_blank" rel="noopener">2018年5月 (1)</a> </li>

<li><a id="CatList_LinkList_0_Link_11" href="https://www.cnblogs.com/huxi2b/archive/2018/04.html" target="_blank" rel="noopener">2018年4月 (1)</a> </li>

<li><a id="CatList_LinkList_0_Link_12" href="https://www.cnblogs.com/huxi2b/archive/2018/03.html" target="_blank" rel="noopener">2018年3月 (1)</a> </li>

<li><a id="CatList_LinkList_0_Link_13" href="https://www.cnblogs.com/huxi2b/archive/2018/02.html" target="_blank" rel="noopener">2018年2月 (3)</a> </li>

<li><a id="CatList_LinkList_0_Link_14" href="https://www.cnblogs.com/huxi2b/archive/2018/01.html" target="_blank" rel="noopener">2018年1月 (1)</a> </li>

<li><a id="CatList_LinkList_0_Link_15" href="https://www.cnblogs.com/huxi2b/archive/2017/12.html" target="_blank" rel="noopener">2017年12月 (1)</a> </li>

<li><a id="CatList_LinkList_0_Link_16" href="https://www.cnblogs.com/huxi2b/archive/2017/11.html" target="_blank" rel="noopener">2017年11月 (3)</a> </li>

<li><a id="CatList_LinkList_0_Link_17" href="https://www.cnblogs.com/huxi2b/archive/2017/10.html" target="_blank" rel="noopener">2017年10月 (1)</a> </li>

<li><a id="CatList_LinkList_0_Link_18" href="https://www.cnblogs.com/huxi2b/archive/2017/09.html" target="_blank" rel="noopener">2017年9月 (2)</a> </li>

<li><a id="CatList_LinkList_0_Link_19" href="https://www.cnblogs.com/huxi2b/archive/2017/08.html" target="_blank" rel="noopener">2017年8月 (3)</a> </li>

<li><a id="CatList_LinkList_0_Link_20" href="https://www.cnblogs.com/huxi2b/archive/2017/07.html" target="_blank" rel="noopener">2017年7月 (3)</a> </li>

<li><a id="CatList_LinkList_0_Link_21" href="https://www.cnblogs.com/huxi2b/archive/2017/06.html" target="_blank" rel="noopener">2017年6月 (6)</a> </li>

<li><a id="CatList_LinkList_0_Link_22" href="https://www.cnblogs.com/huxi2b/archive/2017/05.html" target="_blank" rel="noopener">2017年5月 (3)</a> </li>

<li><a id="CatList_LinkList_0_Link_23" href="https://www.cnblogs.com/huxi2b/archive/2017/04.html" target="_blank" rel="noopener">2017年4月 (2)</a> </li>

<li><a id="CatList_LinkList_0_Link_24" href="https://www.cnblogs.com/huxi2b/archive/2017/03.html" target="_blank" rel="noopener">2017年3月 (4)</a> </li>

<li><a id="CatList_LinkList_0_Link_25" href="https://www.cnblogs.com/huxi2b/archive/2017/02.html" target="_blank" rel="noopener">2017年2月 (2)</a> </li>

<li><a id="CatList_LinkList_0_Link_26" href="https://www.cnblogs.com/huxi2b/archive/2017/01.html" target="_blank" rel="noopener">2017年1月 (1)</a> </li>

<li><a id="CatList_LinkList_0_Link_27" href="https://www.cnblogs.com/huxi2b/archive/2016/12.html" target="_blank" rel="noopener">2016年12月 (2)</a> </li>

<li><a id="CatList_LinkList_0_Link_28" href="https://www.cnblogs.com/huxi2b/archive/2016/11.html" target="_blank" rel="noopener">2016年11月 (3)</a> </li>

<li><a id="CatList_LinkList_0_Link_29" href="https://www.cnblogs.com/huxi2b/archive/2016/10.html" target="_blank" rel="noopener">2016年10月 (1)</a> </li>

<li><a id="CatList_LinkList_0_Link_30" href="https://www.cnblogs.com/huxi2b/archive/2016/09.html" target="_blank" rel="noopener">2016年9月 (2)</a> </li>

<li><a id="CatList_LinkList_0_Link_31" href="https://www.cnblogs.com/huxi2b/archive/2015/09.html" target="_blank" rel="noopener">2015年9月 (1)</a> </li>

<li><a id="CatList_LinkList_0_Link_32" href="https://www.cnblogs.com/huxi2b/archive/2015/08.html" target="_blank" rel="noopener">2015年8月 (2)</a> </li>

<li><a id="CatList_LinkList_0_Link_33" href="https://www.cnblogs.com/huxi2b/archive/2015/07.html" target="_blank" rel="noopener">2015年7月 (1)</a> </li>

<li><a id="CatList_LinkList_0_Link_34" href="https://www.cnblogs.com/huxi2b/archive/2015/06.html" target="_blank" rel="noopener">2015年6月 (7)</a> </li>

<li><a id="CatList_LinkList_0_Link_35" href="https://www.cnblogs.com/huxi2b/archive/2015/05.html" target="_blank" rel="noopener">2015年5月 (5)</a> </li>

<li><a id="CatList_LinkList_0_Link_36" href="https://www.cnblogs.com/huxi2b/archive/2015/04.html" target="_blank" rel="noopener">2015年4月 (7)</a> </li>

<li><a id="CatList_LinkList_0_Link_37" href="https://www.cnblogs.com/huxi2b/archive/2015/03.html" target="_blank" rel="noopener">2015年3月 (5)</a> </li>

</ul>

</div>

<div class="catListImageCategory">
<h3 class="catListTitle">相册</h3>

<ul>

<li><a id="CatList_LinkList_1_Link_0" href="https://www.cnblogs.com/huxi2b/gallery/1030242.html" rel="noopener" target="_blank">kafka(4)</a> </li>

</ul>

</div>

</div><div id="sidebar_recentcomments" class="sidebar-block"><div id="recent_comments_wrap">
<div class="catListComment">
<h3 class="catListTitle">最新评论</h3>
	<div id="RecentCommentsBlock"><ul>
        <li class="recent_comment_title"><a href="https://www.cnblogs.com/huxi2b/p/10330607.html#4203854" target="_blank" rel="noopener">1. Re:Kafka 2.1.0压缩算法性能测试</a></li>
        <li class="recent_comment_body">有个问题请教下，尽管客户端 producer负责压缩，consumer 负责解压；但是broker 端仍然会做解压缩（没有downconvert的情况），似乎在broker 端对record会做 va......</li>
        <li class="recent_comment_author">--hkw</li>
        <li class="recent_comment_title"><a href="https://www.cnblogs.com/huxi2b/p/9860192.html#4195256" target="_blank" rel="noopener">2. Re:关于Kafka broker IO的讨论</a></li>
        <li class="recent_comment_body">@tianxia2s 嗯，再好的理论分析也不如一次详尽测试来的靠谱，我觉得做一次彻底的测试是非常有必要的。主要观测broker端物理IO读的使用率即可，特别是在Hadoop应用高峰时的表现。对于正常的......</li>
        <li class="recent_comment_author">--huxihx</li>
        <li class="recent_comment_title"><a href="https://www.cnblogs.com/huxi2b/p/9860192.html#4195138" target="_blank" rel="noopener">3. Re:关于Kafka broker IO的讨论</a></li>
        <li class="recent_comment_body">@huxihx谢谢您的回复。提出这个问题是因为，我想将Kafka集群与Hadoop集群安装在一块，这样做能节省服务器支出。但是后来了解到Kafka会利用Linux的page cache特性来改善bro......</li>
        <li class="recent_comment_author">--tianxia2s</li>
        <li class="recent_comment_title"><a href="https://www.cnblogs.com/huxi2b/p/9860192.html#4195018" target="_blank" rel="noopener">4. Re:关于Kafka broker IO的讨论</a></li>
        <li class="recent_comment_body">@tianxia2s不太清楚你所说的“在内存足够的情况下”是指多足够？通常的结论是在有限的pagecache下各个应用的争用会造成磁盘IO读性能的下降...</li>
        <li class="recent_comment_author">--huxihx</li>
        <li class="recent_comment_title"><a href="https://www.cnblogs.com/huxi2b/p/9860192.html#4194834" target="_blank" rel="noopener">5. Re:关于Kafka broker IO的讨论</a></li>
        <li class="recent_comment_body">您好，关于pagecache有个问题想向你请教。现在已经知道Kafka会使用到pagecache，Hadoop中HDFS也会使用到pagecache，在内存足够的情况下，将两个分布式集群装在相同主机上......</li>
        <li class="recent_comment_author">--tianxia2s</li>
</ul>
</div>
</div>
</div></div><div id="sidebar_topviewedposts" class="sidebar-block"><div id="topview_posts_wrap">
<div class="catListView">
<h3 class="catListTitle">阅读排行榜</h3>
	<div id="TopViewPostsBlock"><ul><li><a href="https://www.cnblogs.com/huxi2b/p/6223228.html" target="_blank" rel="noopener">1. Kafka消费组(consumer group)(51807)</a></li><li><a href="https://www.cnblogs.com/huxi2b/p/6061110.html" target="_blank" rel="noopener">2. Kafka 如何读取offset topic内容 (__consumer_offsets)(41014)</a></li><li><a href="https://www.cnblogs.com/huxi2b/p/4757098.html" target="_blank" rel="noopener">3. 【原创】如何确定Kafka的分区数、key和consumer线程数(40072)</a></li><li><a href="https://www.cnblogs.com/huxi2b/p/5923252.html" target="_blank" rel="noopener">4. Kafka如何创建topic？(36235)</a></li><li><a href="https://www.cnblogs.com/huxi2b/p/6592862.html" target="_blank" rel="noopener">5. Kafka Java API操作topic(20365)</a></li></ul></div>
</div>
</div></div><div id="sidebar_topcommentedposts" class="sidebar-block"><div id="topfeedback_posts_wrap">
<div class="catListFeedback">
<h3 class="catListTitle">评论排行榜</h3>
	<div id="TopFeedbackPostsBlock"><ul><li><a href="https://www.cnblogs.com/huxi2b/p/6124937.html" target="_blank" rel="noopener">1. 【原创】Kafka Consumer多线程实例(50)</a></li><li><a href="https://www.cnblogs.com/huxi2b/p/6056364.html" target="_blank" rel="noopener">2. Kafka无消息丢失配置(44)</a></li><li><a href="https://www.cnblogs.com/huxi2b/p/6223228.html" target="_blank" rel="noopener">3. Kafka消费组(consumer group)(34)</a></li><li><a href="https://www.cnblogs.com/huxi2b/p/6061110.html" target="_blank" rel="noopener">4. Kafka 如何读取offset topic内容 (__consumer_offsets)(32)</a></li><li><a href="https://www.cnblogs.com/huxi2b/p/7453543.html" target="_blank" rel="noopener">5. Kafka水位(high watermark)与leader epoch的讨论(20)</a></li></ul></div>
</div>
</div></div><div id="sidebar_topdiggedposts" class="sidebar-block"><div id="topdigg_posts_wrap">
<div class="catListView">
<h3 class="catListTitle">推荐排行榜</h3>
<div id="TopDiggPostsBlock"><ul><li><a href="https://www.cnblogs.com/huxi2b/p/6223228.html" target="_blank" rel="noopener">1. Kafka消费组(consumer group)(15)</a></li><li><a href="https://www.cnblogs.com/huxi2b/p/6061110.html" target="_blank" rel="noopener">2. Kafka 如何读取offset topic内容 (__consumer_offsets)(7)</a></li><li><a href="https://www.cnblogs.com/huxi2b/p/6124937.html" target="_blank" rel="noopener">3. 【原创】Kafka Consumer多线程实例(6)</a></li><li><a href="https://www.cnblogs.com/huxi2b/p/4757098.html" target="_blank" rel="noopener">4. 【原创】如何确定Kafka的分区数、key和consumer线程数(6)</a></li><li><a href="https://www.cnblogs.com/huxi2b/p/4842695.html" target="_blank" rel="noopener">5. Kafka0.8.2.1删除topic逻辑(6)</a></li></ul></div>
</div></div></div></div><script type="text/javascript">loadBlogSideColumn();</script>
			</div>
			
		</div><!--end: sideBarMain -->
	</div><!--end: sideBar 侧边栏容器 -->
	<div class="clear"></div>
	</div><!--end: main -->
	<div class="clear"></div>
	<div id="footer">
		
<!--done-->
Copyright ©2019 huxihx
	</div><!--end: footer -->
</div><!--end: home 自定义的最大容器 -->



<iframe id="google_osd_static_frame_2933609667057" name="google_osd_static_frame" style="display: none; width: 0px; height: 0px;" src="./Kafka与Flink集成 - huxihx - 博客园_files/saved_resource(2).html"></iframe></body></html>
    </div>
</article>
                </main>
                
                    
    <aside class="col-md-4 sidebar">
        
        
    <div class="widget">
        <h3 class="title">Search</h3>
        <div id="search-form">
            <div id="result-mask" class="hide"></div>
            <div class="search-area">
                
                    <input id="search-key" type="search" autocomplete="off" placeholder="Search What？">
                    <button type="button" class="search-form-submit" id="search-local">localSearch</button>
                
                
            </div>
            <div id="result-wrap" class="hide">
                <div id="search-result"></div>
            </div>
            <div class="hide">
                <template id="search-tpl">
                    <div class="item">
                        <a href="/{path}" title="{title}">
                            <div class="title">{title}</div>
                            <div class="content">{content}</div>
                        </a>
                    </div>
                </template>
            </div>
        </div>
    </div>

        
        
    <div class="widget">
        <h3 class="title">Categories</h3>
        <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/FRM学习之路/"><i class="fa" aria-hidden="true">FRM学习之路</i></a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java/"><i class="fa" aria-hidden="true">Java</i></a><span class="category-list-count">17</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux/"><i class="fa" aria-hidden="true">Linux</i></a><span class="category-list-count">30</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Programming/"><i class="fa" aria-hidden="true">Programming</i></a><span class="category-list-count">17</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/"><i class="fa" aria-hidden="true">Python</i></a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/他山之石/"><i class="fa" aria-hidden="true">他山之石</i></a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/基础技术/"><i class="fa" aria-hidden="true">基础技术</i></a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/大数据学习/"><i class="fa" aria-hidden="true">大数据学习</i></a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/容器技术/"><i class="fa" aria-hidden="true">容器技术</i></a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/数学基础/"><i class="fa" aria-hidden="true">数学基础</i></a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/机器学习/"><i class="fa" aria-hidden="true">机器学习</i></a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/杂七杂八/"><i class="fa" aria-hidden="true">杂七杂八</i></a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/系统设计YY/"><i class="fa" aria-hidden="true">系统设计YY</i></a><span class="category-list-count">7</span></li></ul>
    </div>


        
        
  <div class="widget">
    <h3 class="title">Tag Cloud</h3>
    <div class="content tag-cloud">
        
            <a href="/tags/Docker/" style="font-size: 15.56px;">Docker</a> <a href="/tags/Drools/" style="font-size: 10px;">Drools</a> <a href="/tags/Elasticsearch/" style="font-size: 10px;">Elasticsearch</a> <a href="/tags/Git/" style="font-size: 10px;">Git</a> <a href="/tags/HTML-CSS/" style="font-size: 10px;">HTML&CSS</a> <a href="/tags/Hadoop/" style="font-size: 11.11px;">Hadoop</a> <a href="/tags/Hbase/" style="font-size: 10px;">Hbase</a> <a href="/tags/Hexo/" style="font-size: 12.22px;">Hexo</a> <a href="/tags/Hive/" style="font-size: 10px;">Hive</a> <a href="/tags/JVM/" style="font-size: 14.44px;">JVM</a> <a href="/tags/Java/" style="font-size: 10px;">Java</a> <a href="/tags/JavaScript/" style="font-size: 11.11px;">JavaScript</a> <a href="/tags/Maven/" style="font-size: 10px;">Maven</a> <a href="/tags/MongoDB/" style="font-size: 10px;">MongoDB</a> <a href="/tags/Mysql/" style="font-size: 11.11px;">Mysql</a> <a href="/tags/Oracle/" style="font-size: 10px;">Oracle</a> <a href="/tags/PostgreSQL/" style="font-size: 10px;">PostgreSQL</a> <a href="/tags/Python/" style="font-size: 10px;">Python</a> <a href="/tags/R/" style="font-size: 10px;">R</a> <a href="/tags/Redis/" style="font-size: 11.11px;">Redis</a> <a href="/tags/Scala/" style="font-size: 14.44px;">Scala</a> <a href="/tags/Scikit-Learn/" style="font-size: 10px;">Scikit-Learn</a> <a href="/tags/Spark/" style="font-size: 12.22px;">Spark</a> <a href="/tags/TCP-IP/" style="font-size: 10px;">TCP/IP</a> <a href="/tags/Ubuntu/" style="font-size: 13.33px;">Ubuntu</a> <a href="/tags/gradle/" style="font-size: 10px;">gradle</a> <a href="/tags/mac/" style="font-size: 10px;">mac</a> <a href="/tags/世界观/" style="font-size: 10px;">世界观</a> <a href="/tags/中间件/" style="font-size: 18.89px;">中间件</a> <a href="/tags/互联网/" style="font-size: 12.22px;">互联网</a> <a href="/tags/函数式编程/" style="font-size: 10px;">函数式编程</a> <a href="/tags/分布式/" style="font-size: 20px;">分布式</a> <a href="/tags/多线程/" style="font-size: 17.78px;">多线程</a> <a href="/tags/工作流/" style="font-size: 11.11px;">工作流</a> <a href="/tags/常用/" style="font-size: 16.67px;">常用</a> <a href="/tags/德鲁克/" style="font-size: 10px;">德鲁克</a> <a href="/tags/数学/" style="font-size: 10px;">数学</a> <a href="/tags/数据库/" style="font-size: 11.11px;">数据库</a> <a href="/tags/数据科学/" style="font-size: 11.11px;">数据科学</a> <a href="/tags/更新/" style="font-size: 11.11px;">更新</a> <a href="/tags/架构/" style="font-size: 10px;">架构</a> <a href="/tags/概率论/" style="font-size: 10px;">概率论</a> <a href="/tags/武侠/" style="font-size: 10px;">武侠</a> <a href="/tags/流计算/" style="font-size: 10px;">流计算</a> <a href="/tags/消息队列/" style="font-size: 10px;">消息队列</a> <a href="/tags/源码阅读/" style="font-size: 13.33px;">源码阅读</a> <a href="/tags/统计学/" style="font-size: 10px;">统计学</a> <a href="/tags/网站开发/" style="font-size: 10px;">网站开发</a> <a href="/tags/规则引擎/" style="font-size: 10px;">规则引擎</a> <a href="/tags/规则系统/" style="font-size: 10px;">规则系统</a> <a href="/tags/读书/" style="font-size: 12.22px;">读书</a> <a href="/tags/风险管理/" style="font-size: 14.44px;">风险管理</a> <a href="/tags/高并发/" style="font-size: 16.67px;">高并发</a>
        
    </div>
  </div>


        
        
    <div class="widget">
      <h3 class="title">Social</h3> 
        <div class="content social">
            
	            <a href="//github.com/klwork" rel="external nofollow" title="Github" target="_blank">
			    	<i class="git fa fa-git"></i>
			    </a>
            
	            <a href="mailto:wangwei_fir@126.com" rel="external nofollow" title="邮箱" target="_blank">
			    	<i class="envelope-o fa fa-envelope-o"></i>
			    </a>
            
	            <a href="/atom.xml" rel="external nofollow" title="RSS" target="_blank">
			    	<i class="feed fa fa-feed"></i>
			    </a>
            
        </div>
    </div>


        
    </aside>

                
            </div>
        </div>
    </section>
    <footer class="main-footer">
    <div class="container">
        <div class="row">
        </div>
    </div>
</footer>

<a id="back-to-top" class="icon-btn hide">
	<i class="fa fa-chevron-up"></i>
</a>




    <div class="copyright">
    <div class="container">
        <div class="row">
            <div class="col-sm-12">
                <div class="busuanzi">
    
</div>

            </div>
            <div class="col-sm-12">
                <span>Copyright &copy; 2017
                </span> |
                <span>
                    Powered by <a href="//hexo.io" class="copyright-links" target="_blank" rel="nofollow">Hexo</a>
                </span> |
                <span>
                    Theme by <a href="//github.com/shenliyang/hexo-theme-snippet.git" class="copyright-links" target="_blank" rel="nofollow">Snippet</a>
                </span>
            </div>
        </div>
    </div>
</div>


	<script src="/js/search.js?rev=@@hash"></script>






<script src="/js/app.js?rev=@@hash"></script>
<script src="http://libs.baidu.com/jquery/2.0.3/jquery.min.js"></script>

</body>
</html>